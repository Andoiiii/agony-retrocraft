\documentclass[class=pmath370,tikz,notes]{agony}

\title{PMATH 370 Winter 2024: Lecture Notes}
\begin{document}
\renewcommand{\contentsname}{PMATH 370 Winter 2024:\\{\huge Lecture Notes}}
\thispagestyle{firstpage}
\tableofcontents

Lecture notes taken, unless otherwise specified,
by myself during the Winter 2024 offering of PMATH 370,
taught by Blake Madill.

\begin{multicols}{2}
  \listoflecture
\end{multicols}

\chapter{Iteration and Orbits}

\section{Orbits}
\lecture{Jan 8}

\begin{defn}[iteration]
  Let $f : A \to \R$ such that $A \subseteq \R$ and $f(A) \subseteq A$.
  For $a \in A$ we may \term[iteration]{iterate} the function at $a$:
  \[ x_1 = a, x_2 = f(a), x_3 = \underbrace{f(f(a))}_{f^2(a)}, \dotsc, x_i = f^{i-1}(a), \dotsc. \]
  The sequence $(x_n)_{n=1}^\infty$ is the \term[orbit]{orbit of $a$ under $f$}
  (abbreviated $(x_n)$ without limits).
\end{defn}

\begin{example}
  Let $f(x) = x^4 + 2x^2 - 2$, $a = -1$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  $a = -1$, $f(a) = 1$, $f(f(a)) = f(1) = 1$, so we have $-1,1,1,1,\dotsc$.
  We call this eventually constant.
\end{sol}

\begin{example}
  Let $f(x) = -x^2 - x + 1$, $a = 0$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate: $0, 1, -1, 1, -1, 1, \dotsc$.
  We call this eventually periodic (with period 2).
\end{sol}

\begin{example}
  Let $f(x) = x^3 - 3x + 1$, $a = 1$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate the first few terms: $1, -1, 3, 19, \dotsc$ (too big).
  This is a divergence to infinity.
\end{sol}

\begin{example}
  Let $f(x) = x^2 + 2x$, $a = -0.5$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate: $-0.5, -0.75, -0.9375, -0.9961\dots$
  and we make an educated guess that this converges to $-1$
  since $f(-1) = -1$, a fixed point.
\end{sol}

\begin{example}
  Let $f(x) = x^3 - 3x$, $a = 0.75$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate: $0.75, -1.828, -0.625, 1.631, -0.552, \dotsc$.
  There is no clear pattern, so we call this chaotic.
  In fact, the orbit is dense in a neighbourhood of 0.
\end{sol}

We can start to formalize the examples.

\begin{defn}[fixed point]
  Let $f : A \to \R$ such that $f(A) \subseteq A$.
  A point $a \in A$ is fixed if $f(a) = a$.

  Then, the orbit of $a$ under $f$ is $(a,a,a,\dotsc)$
  which is \term[orbit!constant]{constant}.
\end{defn}

\begin{example}
  Find all fixed points of $f(x) = x^2 + x - 4$.
\end{example}
\begin{sol}
  We find points where $f(x) = x$, i.e., $x^2 + x - 4 = x$.
  \begin{equation*}
    x^2 + x - 4 = x \iff x^2 = 4 \iff x = \pm 2 \qedhere
  \end{equation*}
\end{sol}

\begin{example}
  How many fixed points does $f(x) = 2\sin x$ have?
\end{example}
\begin{sol}
  Consider where the curve $y = 2\sin x$ meets $y = x$:
  \begin{center}
    \begin{tikzpicture}
      \begin{axis}[axis lines=middle,
          xlabel=$x$,
          ylabel=$y$,
          enlargelimits,
          ytick=\empty,
          xtick=\empty,
          samples=60]
        \addplot[name path=F,blue,domain={-6:6}] {2*sin(deg(x))} node[pos=.9, below]{$y = 2\sin x$};
        \addplot[name path=G,ForestGreen,domain={-4:4}] {x} node[pos=.8, left]{$y = x$};
      \end{axis}
    \end{tikzpicture}
  \end{center}
  We can see there are three fixed points.
\end{sol}

\begin{example}
  Prove that $f(x) = x^4 - 3x + 1$ has a fixed point.
\end{example}
\begin{prf}
  We must show there is a solution to $x^4 - 3x + 1 \iff x^4 - 4x + 1 = 0$.
  Let $g(x) = x^4 - 4x + 1$.
  Since $g(x)$ is continuous, $g(0) = 1 > 0$, and $g(1) = -2 < 0$,
  by the Intermediate Value Theorem, there must exist a root of $g$ on the interval $(0,1)$.
  That is, a fixed point of $f$.
\end{prf}

\begin{defn}[periodicity]
  Let $f : A \to \R, f(A) \subseteq A$.
  \begin{enumerate}[nosep]
    \item A point $a \in A$ is \term[point!periodic]{periodic} for $f$ if its orbit is periodic.
          An orbit is \term[orbit!periodic]{periodic} if for some $n \in \N$, $f^n(a) = a$.
          The smallest $n$ is the \term{period} of (the orbit of) $a$.
    \item An orbit (of a point) is \term[orbit!eventually periodic]{eventually periodic}
          if there exists $n < m$ such that $f^n(a) = f^m(a)$.
          The smallest difference $m-n$ is the period of the orbit.
  \end{enumerate}
\end{defn}

\lecture{Jan 10}
\begin{defn}[doubling function]
  $D : [0,1) \to [0,1) : x \mapsto 2x-\floor{2x}$
  returns the fractional part of $2x$.
\end{defn}
\begin{example}
  $D(0.4) = 0.8$, $D(0.6) = 0.2$, $D(0.8) = 0.6$, $D(0.5) = 0$.
\end{example}

This is a nice function that gives lots of periodic orbits for funsies.

\begin{example}\label{ex:orbit1}
  Find the orbit of $a=\frac15$ under $D$.
\end{example}
\begin{sol}
  Double until we pass 1: $\frac15, \frac25, \frac45, \frac85 \to \frac35, \frac65 \to \frac15$.
  The period is $\abs{\{\frac15,\frac25,\frac45,\frac35\}} = 4$.
\end{sol}

\begin{example}
  Find the orbit of $a=\frac1{20}$ under $D$.
\end{example}
\begin{sol}
  Double: $\frac1{20}, \frac1{10}, \frac15$ and we can stop
  because \cref{ex:orbit1} showed $\frac15$ is periodic.

  So this is eventually periodic with period 4.
\end{sol}

\begin{problem}
  Given $f$ and $a$, does $f^n(a)$ tend towards some limit $L$?
\end{problem}

To solve this problem, we need to rigorously define ``tend'' and ``limit''.

\section{Real Analysis Review}

\begin{notation}
  If $(x_n)_{n=1}^\infty$ is a sequence of real numbers,
  we write $(x_n) \subseteq \R$.
\end{notation}

\begin{defn*}[convergence of a sequence]
  Let $(x_n) \subseteq \R$, $x \in \R$.

  We say $(x_n)$ \term[sequence!convergence]{converges} to $x$ if
  for all $\varepsilon > 0$, there exists $N \in \N$
  such that $\abs{x_n - x} < \varepsilon$ for all $n \geq N$.

  Then, we write $x_n \to x$ or $\lim x_n = x$.
\end{defn*}

\begin{example}
  Show that $\frac1n \to 0$.
\end{example}
\begin{prf}
  Let $\varepsilon > 0$. Consider $N = \frac{2}{\varepsilon} > \frac{1}{\varepsilon}$.
  For $n \geq N$, we have
  \[ \abs{\frac1n - 0} = \frac1n < \varepsilon \]
  Therefore, $\frac1n \to 0$.
\end{prf}

\begin{example}
  Prove that $\frac{2n}{n+3} \to 2$.
\end{example}
\begin{prf}
  Let $\varepsilon > 0$.
  Since we know $\frac1n \to 0$,
  let $N \in \N$ such that $\frac1N < \frac{\varepsilon}{6}$.

  For $n \geq N$,
  \begin{align*}
    \abs{\frac{2n}{n+3} - 2} = \abs{\frac{2n}{n+3} - \frac{2n+6}{n+3}}
    = \abs{\frac{-6}{n+3}}
    = \frac{6}{n+3}
    < \frac{6}{n}
    \leq \frac{6}{N}
    < 6\cdot\frac{\varepsilon}{6}
    = \varepsilon
  \end{align*}
  Therefore, $\frac{2n}{n+3} \to 2$.
\end{prf}

\begin{defn*}[bounded sequence]
  A sequence $(x_n)$ is \term[sequence!bounded]{bounded} (by $M$)
  if there exists $M > 0$ such that $\forall n\in\N$, $\abs{x_n} \leq M$.
\end{defn*}

\begin{prop}[convergence implies boundedness]
  If $(x_n)$ is convergent, then $(x_n)$ is bounded.
\end{prop}
\begin{prf}
  Suppose $x_n \to x$.
  Then, there exists $N \in \N$ such that if $n \geq N$,
  then $\abs{x_n - x} < 1$.

  For $n \geq N$, $\abs{x_n} - \abs{x} \leq \abs{x_n-x} < 1$.
  That is, $\abs{x_n} < 1 + \abs{x}$.

  Let $M = \max\{\abs{x_1},\dotsc,\abs{x_{n-1}},1+\abs{x}\}$.
  Then, for both all $n < N$ and $n \geq N$, we have $\abs{x_n} \leq M$.
\end{prf}

\begin{remark}
  The converse is not true. Notice that $x_n = (-1)^n$ is bounded by 1
  but obviously not convergent.
\end{remark}

\begin{prop}[limit laws]
  Let $x_n \to x$ and $y_n \to y$. Then:
  \begin{enumerate}[(1)]
    \item $x_n + y_n \to x + y$
    \item $x_ny_n \to xy$
  \end{enumerate}
\end{prop}
\begin{prf}
  (1) Let $\varepsilon > 0$.
  Then, since $x_n \to x$ and $y_n \to y$,
  there exist $N_1,N_2 \in \N$ such that $n \geq N_1 \implies \abs{x_n - x} < \frac\varepsilon2$
  and $n \geq N_2 \implies \abs{y_n - y} < \frac\varepsilon2$.

  For $N = \max\{N_1,N_2\}$ and $n \geq N$,
  \begin{align*}
    \abs{(x_n + y_n) - (x + y)}
     & = \abs{(x_n - x) + (y_n - y)}           \\
     & \leq \abs{x_n-x} + \abs{y_n-y}          \\
     & < \frac\varepsilon2 + \frac\varepsilon2 \\
     & = \varepsilon
  \end{align*}
  That is, $x_n + y_n \to x+y$.

  (2) Let $\varepsilon > 0$. Notice that:
  \begin{equation*}
    \abs{x_ny_n - xy} = \abs{x_ny_n - x_ny + x_ny - xy}
    \leq \abs{x_n}\cdot\abs{y_n-y} + \abs{y}\cdot\abs{x_n-x}
    \tag{\ast}
  \end{equation*}
  Since $x_n$ is bounded, there exists $M > 0$ such that
  $\abs{x_n} \leq M$ for all $n$.

  Let $N_1,N_2 \in \N$ such that
  \begin{align*}
    n \geq N_1 & \implies \abs{x_n - x} \leq \frac{\varepsilon}{2(\abs{y}+1)}\text{ and} \\
    n \geq N_2 & \implies \abs{y_n-y} < \frac{\varepsilon}{2M}.
  \end{align*}
  Then, for $n \geq N := \max\{N_1,N_2\}$,
  $\abs{x_ny_n - xy} < \frac\varepsilon2 + \frac\varepsilon2 = \varepsilon$
  by $(\ast)$.
\end{prf}

\lecture{Jan 12}
\begin{defn*}[Cauchy sequence]
  We say $(x_n) \in \R$ is \term[sequence!Cauchy]{Cauchy}
  if for all $\varepsilon > 0$, there exists $N \in \N$ such that
  for all $n$ and $m$,
  \[ n,m \geq N \implies \abs{x_n - x_m} < \varepsilon \]
\end{defn*}

\begin{prop}
  Every convergent sequence is Cauchy.
\end{prop}
\begin{prf}
  Intuitively: if the terms get arbitrarily close to some limit,
  they must get arbitrarily close to each other.

  Formally: Let $x_n \to x$ be a convergent sequence and $\varepsilon > 0$.
  Since $x_n$ converges, there exists $N \in \N$ such that
  $n \geq N \implies \abs{x_n-x} < \frac\varepsilon2$.

  Then, when $n,m \geq N$, we have:
  \begin{align*}
    \abs{x_n - x_m}
     & = \abs{x_n - x_m + x - x}               \\
     & = \abs{(x_n - x) + (x - x_m)}           \\
     & \leq \abs{x_n - x} + \abs{x_m - x}      \\
     & < \frac\varepsilon2 + \frac\varepsilon2 \\
     & = \varepsilon
  \end{align*}
  as desired.
\end{prf}

We take the following theorem from real analysis without proof.

\begin{theorem}[completeness of $\R$]
  A sequence is Cauchy if and only if it is convergent.
\end{theorem}

The big idea here: To prove $(x_n)$ is Cauchy,
you do not have to guess the limit first.
That is, if you must prove convergence but do not care about the limit's value,
prove that it is Cauchy instead.

\begin{defn*}[continuity of a function]
  Let $f : A \to \R, A \subseteq \R, a \in A$.
  We say $f$ is \term[function!continuity]{continuous at $a$} if
  for all $\varepsilon > 0$, there exists $\delta > 0$
  such that $\abs{f(x) - f(a)} < \varepsilon$ whenever
  $x \in A$ and $\abs{x-a} < \delta$.

  If $f$ is continuous at all $a \in A$, we say it is continuous.
\end{defn*}

We also take this theorem from MATH 137 without proof.

\begin{theorem}
  A function $f : A \to \R$ is continuous at $a \in A$ if and only if
  for all sequences $(x_n) \subseteq A$ with $x_n \to a$,
  we have $f(x_n) \to a$.
\end{theorem}

\section{Orbits, revisited}

\begin{prop}
  If $f : [a,b] \to [a,b]$ is continuous, then $f(x)$ has a fixed point.
\end{prop}
\begin{prf}
  We know by the domain and codomain that $f(a) \geq a$ and $f(b) \leq b$.
  This means $f(a) - a \geq 0$ and $f(b) - b \leq 0$.
  By the IVT on the continuous function $g(x) = f(x) - x$,
  we know there exists an $x \in [a,b]$ such that $g(x) = f(x) - x = 0 \iff f(x) = x$,
  i.e., $x$ is a fixed point.
\end{prf}

\begin{defn*}[contraction]
  Let $f : A \to \R, A \subseteq \R$.
  We say $f$ is a \term{contraction} if there exists $C \in [0,1)$
  such that for all $x,a \in A$,
  \[ \abs{f(x) - f(y)} \leq C\abs{x-y} \]
\end{defn*}

This is just a Lipschitz function with Lipschitz constant less than 1.

\begin{prop}
  Contractions are continuous.
\end{prop}
\begin{prf}
  Let $\varepsilon > 0$.
  Suppose $f$ is a contraction such that $\abs{f(x) - f(y)} \leq C\abs{x-y}$.

  Consider $y \in A$.
  Let $\delta = \frac{\varepsilon}{C+1}$
  and assume that $x \in A$ and $\abs{x-y} < \delta$.
  But we have:
  \begin{align*}
    \abs{f(x) - f(y)} \leq C\abs{x-y} \leq C\delta < \varepsilon
  \end{align*}
  as desired.
\end{prf}

\begin{defn*}[closure of an interval]
  We say $A \in \R$ is \term[interval!closure]{closed}
  if whenever $(x_n) \subseteq A$ with $x_n \to x$,
  then $x \in A$.
\end{defn*}

\begin{example}
  $[a,b]$ is closed but $(0,1]$ is not because $\frac1n \to 0 \not\in (0,1]$.
\end{example}

\begin{theorem}[Banach contraction mapping theorem]
  Suppose $A \subseteq \R$ is closed and $f : A \to A$ is a contraction.
  Then, there exists a unique fixed point $a \in A$ for $f$.

  Moreover, for all $x \in A$, $f^n(x) \to a$.
\end{theorem}

\begin{example}
  Analyze the orbit of $f : [0,1] \to [0,1]$, $f(x) = \frac{1}{3-x}$.
\end{example}
\begin{sol}
  We can observe that $\frac13 \leq \frac{1}{3-x} \leq \frac12$.

  Also, $f'(x) = \frac{1}{(3-x)^2}$.
  Notice that $\frac19 \leq \abs{f'(x)} \leq \frac14$.
  So by the mean value theorem, for all $x,y \in [0,1]$,
  there exists $c \in (0,1)$ such that:
  \begin{align*}
    f(x) - f(y)       & = f'(c)(x-y)                \\
    \abs{f(x) - f(y)} & = \abs{f'(c)}\cdot\abs{x-y} \\
                      & \leq \frac14\abs{x-y}
  \end{align*}
  Then, identifying $C = \frac14$, $f$ is a contraction. Now,
  \begin{align*}
    \frac{1}{3-x} = x \iff 1 = 3x-x^2 \iff x^2 - 3x + 1 = 0 \iff x = \frac{3\pm \sqrt{9-4}}{2} \iff x = \frac{3-\sqrt{5}}{2}
  \end{align*}
  where we pick the negative root because we need $x \in [0,1]$.
  
  Therefore, by the Banach contraction mapping theorem,
  for all $x \in [0,1]$, $f^n(x) \to \frac{3-\sqrt5}{2}$.
\end{sol}


\pagebreak
\phantomsection\addcontentsline{toc}{chapter}{Back Matter}
\renewcommand{\listtheoremname}{List of Named Results}
\phantomsection\addcontentsline{toc}{section}{\listtheoremname}
\listoftheorems[ignoreall,onlynamed={theorem,lemma,corollary,prop}]
\printindex

\end{document}
