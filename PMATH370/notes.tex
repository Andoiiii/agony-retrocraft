\documentclass[class=pmath370,tikz,notes]{agony}
\usetikzlibrary{external}
\tikzexternalize[prefix=figures-cache/]
\tikzset{external/only named=true}
\declaretheorem[name=Cryptoscheme,refname={scheme,scheme},style=thmroundpink]{scheme}

\title{PMATH 370 Winter 2024: Lecture Notes}
\begin{document}
\renewcommand{\contentsname}{PMATH 370 Winter 2024:\\{\huge Lecture Notes}}
\thispagestyle{firstpage}
\tableofcontents

Lecture notes taken, unless otherwise specified,
by myself during the Winter 2024 offering of PMATH 370,
taught by Blake Madill.

\begin{multicols}{2}
  \listoflecture
\end{multicols}

\chapter{Iteration and Orbits}

\section{Orbits}
\lecture{Jan 8}

\begin{defn}[iteration]
  Let $f : A \to \R$ such that $A \subseteq \R$ and $f(A) \subseteq A$.
  For $a \in A$ we may \term[iteration]{iterate} the function at $a$:
  \[ x_1 = a, x_2 = f(a), x_3 = \underbrace{f(f(a))}_{f^2(a)}, \dotsc, x_i = f^{i-1}(a), \dotsc. \]
  The sequence $(x_n)_{n=1}^\infty$ is the \term[orbit]{orbit of $a$ under $f$}
  (abbreviated $(x_n)$ without limits).
\end{defn}

\begin{example}
  Let $f(x) = x^4 + 2x^2 - 2$, $a = -1$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  $a = -1$, $f(a) = 1$, $f(f(a)) = f(1) = 1$, so we have $-1,1,1,1,\dotsc$.
  We call this eventually constant.
\end{sol}

\begin{example}
  Let $f(x) = -x^2 - x + 1$, $a = 0$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate: $0, 1, -1, 1, -1, 1, \dotsc$.
  We call this eventually periodic (with period 2).
\end{sol}

\begin{example}
  Let $f(x) = x^3 - 3x + 1$, $a = 1$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate the first few terms: $1, -1, 3, 19, \dotsc$ (too big).
  This is a divergence to infinity.
\end{sol}

\begin{example}
  Let $f(x) = x^2 + 2x$, $a = -0.5$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate: $-0.5, -0.75, -0.9375, -0.9961\dots$
  and we make an educated guess that this converges to $-1$
  since $f(-1) = -1$, a fixed point.
\end{sol}

\begin{example}
  Let $f(x) = x^3 - 3x$, $a = 0.75$. What is the orbit of $a$ under $f$?
\end{example}
\begin{sol}
  Calculate: $0.75, -1.828, -0.625, 1.631, -0.552, \dotsc$.
  There is no clear pattern, so we call this chaotic.
  In fact, the orbit is dense in a neighbourhood of 0.
\end{sol}

We can start to formalize the examples.

\begin{defn}[fixed point]
  Let $f : A \to \R$ such that $f(A) \subseteq A$.
  A point $a \in A$ is fixed if $f(a) = a$.

  Then, the orbit of $a$ under $f$ is $(a,a,a,\dotsc)$
  which is \term[orbit!constant]{constant}.
\end{defn}

\begin{example}
  Find all fixed points of $f(x) = x^2 + x - 4$.
\end{example}
\begin{sol}
  We find points where $f(x) = x$, i.e., $x^2 + x - 4 = x$.
  \begin{equation*}
    x^2 + x - 4 = x \iff x^2 = 4 \iff x = \pm 2 \qedhere
  \end{equation*}
\end{sol}

\begin{example}\label{ex:graph}
  How many fixed points does $f(x) = 2\sin x$ have?
\end{example}
\begin{sol}
  Consider where the curve $y = 2\sin x$ meets $y = x$:
  \begin{center}
    \begin{tikzpicture}
      \begin{axis}[axis lines=middle,
          xlabel=$x$,
          ylabel=$y$,
          enlargelimits,
          ytick=\empty,
          xtick=\empty,
          samples=60]
        \addplot[name path=F,blue,domain={-6:6}] {2*sin(deg(x))} node[pos=.9, below]{$y = 2\sin x$};
        \addplot[name path=G,ForestGreen,domain={-4:4}] {x} node[pos=.8, left]{$y = x$};
      \end{axis}
    \end{tikzpicture}
  \end{center}
  We can see there are three fixed points.
\end{sol}

\begin{example}
  Prove that $f(x) = x^4 - 3x + 1$ has a fixed point.
\end{example}
\begin{prf}
  We must show there is a solution to $x^4 - 3x + 1 \iff x^4 - 4x + 1 = 0$.
  Let $g(x) = x^4 - 4x + 1$.
  Since $g(x)$ is continuous, $g(0) = 1 > 0$, and $g(1) = -2 < 0$,
  by the Intermediate Value Theorem, there must exist a root of $g$ on the interval $(0,1)$.
  That is, a fixed point of $f$.
\end{prf}

\begin{defn}[periodicity]
  Let $f : A \to \R, f(A) \subseteq A$.
  \begin{enumerate}[nosep]
    \item A point $a \in A$ is \term[periodic point]{periodic} for $f$ if its orbit is periodic.
          An orbit is \term[orbit!periodic]{periodic} if for some $n \in \N$, $f^n(a) = a$.
          The smallest $n$ is the \term{period} of (the orbit of) $a$.
    \item An orbit (of a point) is \term[orbit!eventually periodic]{eventually periodic}
          if there exists $n < m$ such that $f^n(a) = f^m(a)$.
          The smallest difference $m-n$ is the period of the orbit.
  \end{enumerate}
\end{defn}

\lecture{Jan 10}
\begin{defn}[doubling function]
  $D : [0,1) \to [0,1) : x \mapsto 2x-\floor{2x}$
  returns the fractional part of $2x$.
\end{defn}
\begin{example}
  $D(0.4) = 0.8$, $D(0.6) = 0.2$, $D(0.8) = 0.6$, $D(0.5) = 0$.
\end{example}

This is a nice function that gives lots of periodic orbits for funsies.

\begin{example}\label{ex:orbit1}
  Find the orbit of $a=\frac15$ under $D$.
\end{example}
\begin{sol}
  Double until we pass 1: $\frac15, \frac25, \frac45, \frac85 \to \frac35, \frac65 \to \frac15$.
  The period is $\abs{\{\frac15,\frac25,\frac45,\frac35\}} = 4$.
\end{sol}

\begin{example}
  Find the orbit of $a=\frac1{20}$ under $D$.
\end{example}
\begin{sol}
  Double: $\frac1{20}, \frac1{10}, \frac15$ and we can stop
  because \cref{ex:orbit1} showed $\frac15$ is periodic.

  So this is eventually periodic with period 4.
\end{sol}

\begin{problem}
  Given $f$ and $a$, does $f^n(a)$ tend towards some limit $L$?
\end{problem}

To solve this problem, we need to rigorously define ``tend'' and ``limit''.

\section{Real analysis review}

\begin{notation}
  If $(x_n)_{n=1}^\infty$ is a sequence of real numbers,
  we write $(x_n) \subseteq \R$.
\end{notation}

\begin{defn*}[convergence of a sequence]
  Let $(x_n) \subseteq \R$, $x \in \R$.

  We say $(x_n)$ \term[sequence!convergence]{converges} to $x$ if
  for all $\varepsilon > 0$, there exists $N \in \N$
  such that $\abs{x_n - x} < \varepsilon$ for all $n \geq N$.

  Then, we write $x_n \to x$ or $\lim x_n = x$.
\end{defn*}

\begin{example}
  Show that $\frac1n \to 0$.
\end{example}
\begin{prf}
  Let $\varepsilon > 0$. Consider $N = \frac{2}{\varepsilon} > \frac{1}{\varepsilon}$.
  For $n \geq N$, we have
  \[ \abs{\frac1n - 0} = \frac1n < \varepsilon \]
  Therefore, $\frac1n \to 0$.
\end{prf}

\begin{example}
  Prove that $\frac{2n}{n+3} \to 2$.
\end{example}
\begin{prf}
  Let $\varepsilon > 0$.
  Since we know $\frac1n \to 0$,
  let $N \in \N$ such that $\frac1N < \frac{\varepsilon}{6}$.

  For $n \geq N$,
  \begin{align*}
    \abs{\frac{2n}{n+3} - 2} = \abs{\frac{2n}{n+3} - \frac{2n+6}{n+3}}
    = \abs{\frac{-6}{n+3}}
    = \frac{6}{n+3}
    < \frac{6}{n}
    \leq \frac{6}{N}
    < 6\cdot\frac{\varepsilon}{6}
    = \varepsilon
  \end{align*}
  Therefore, $\frac{2n}{n+3} \to 2$.
\end{prf}

\begin{defn*}[bounded sequence]
  A sequence $(x_n)$ is \term[sequence!bounded]{bounded} (by $M$)
  if there exists $M > 0$ such that $\forall n\in\N$, $\abs{x_n} \leq M$.
\end{defn*}

\begin{prop}[convergence implies boundedness]
  If $(x_n)$ is convergent, then $(x_n)$ is bounded.
\end{prop}
\begin{prf}
  Suppose $x_n \to x$.
  Then, there exists $N \in \N$ such that if $n \geq N$,
  then $\abs{x_n - x} < 1$.

  For $n \geq N$, $\abs{x_n} - \abs{x} \leq \abs{x_n-x} < 1$.
  That is, $\abs{x_n} < 1 + \abs{x}$.

  Let $M = \max\{\abs{x_1},\dotsc,\abs{x_{n-1}},1+\abs{x}\}$.
  Then, for both all $n < N$ and $n \geq N$, we have $\abs{x_n} \leq M$.
\end{prf}

\begin{remark}
  The converse is not true. Notice that $x_n = (-1)^n$ is bounded by 1
  but obviously not convergent.
\end{remark}

\begin{prop}[limit laws]
  Let $x_n \to x$ and $y_n \to y$. Then:
  \begin{enumerate}[(1)]
    \item $x_n + y_n \to x + y$
    \item $x_ny_n \to xy$
  \end{enumerate}
\end{prop}
\begin{prf}
  (1) Let $\varepsilon > 0$.
  Then, since $x_n \to x$ and $y_n \to y$,
  there exist $N_1,N_2 \in \N$ such that $n \geq N_1 \implies \abs{x_n - x} < \frac\varepsilon2$
  and $n \geq N_2 \implies \abs{y_n - y} < \frac\varepsilon2$.

  For $N = \max\{N_1,N_2\}$ and $n \geq N$,
  \begin{align*}
    \abs{(x_n + y_n) - (x + y)}
     & = \abs{(x_n - x) + (y_n - y)}           \\
     & \leq \abs{x_n-x} + \abs{y_n-y}          \\
     & < \frac\varepsilon2 + \frac\varepsilon2 \\
     & = \varepsilon
  \end{align*}
  That is, $x_n + y_n \to x+y$.

  (2) Let $\varepsilon > 0$. Notice that:
  \begin{equation*}
    \abs{x_ny_n - xy} = \abs{x_ny_n - x_ny + x_ny - xy}
    \leq \abs{x_n}\cdot\abs{y_n-y} + \abs{y}\cdot\abs{x_n-x}
    \tag{\ast}
  \end{equation*}
  Since $x_n$ is bounded, there exists $M > 0$ such that
  $\abs{x_n} \leq M$ for all $n$.

  Let $N_1,N_2 \in \N$ such that
  \begin{align*}
    n \geq N_1 & \implies \abs{x_n - x} \leq \frac{\varepsilon}{2(\abs{y}+1)}\text{ and} \\
    n \geq N_2 & \implies \abs{y_n-y} < \frac{\varepsilon}{2M}.
  \end{align*}
  Then, for $n \geq N := \max\{N_1,N_2\}$,
  $\abs{x_ny_n - xy} < \frac\varepsilon2 + \frac\varepsilon2 = \varepsilon$
  by $(\ast)$.
\end{prf}

\lecture{Jan 12}
\begin{defn*}[Cauchy sequence]
  We say $(x_n) \in \R$ is \term[sequence!Cauchy]{Cauchy}
  if for all $\varepsilon > 0$, there exists $N \in \N$ such that
  for all $n$ and $m$,
  \[ n,m \geq N \implies \abs{x_n - x_m} < \varepsilon \]
\end{defn*}

\begin{prop}
  Every convergent sequence is Cauchy.
\end{prop}
\begin{prf}
  Intuitively: if the terms get arbitrarily close to some limit,
  they must get arbitrarily close to each other.

  Formally: Let $x_n \to x$ be a convergent sequence and $\varepsilon > 0$.
  Since $x_n$ converges, there exists $N \in \N$ such that
  $n \geq N \implies \abs{x_n-x} < \frac\varepsilon2$.

  Then, when $n,m \geq N$, we have:
  \begin{align*}
    \abs{x_n - x_m}
     & = \abs{x_n - x_m + x - x}               \\
     & = \abs{(x_n - x) + (x - x_m)}           \\
     & \leq \abs{x_n - x} + \abs{x_m - x}      \\
     & < \frac\varepsilon2 + \frac\varepsilon2 \\
     & = \varepsilon
  \end{align*}
  as desired.
\end{prf}

We take the following theorem from real analysis without proof.

\begin{theorem}[completeness of $\R$]
  A sequence is Cauchy if and only if it is convergent.
\end{theorem}

The big idea here: To prove $(x_n)$ is Cauchy,
you do not have to guess the limit first.
That is, if you must prove convergence but do not care about the limit's value,
prove that it is Cauchy instead.

\begin{defn*}[continuity of a function]
  Let $f : A \to \R, A \subseteq \R, a \in A$.
  We say $f$ is \term[function!continuity]{continuous at $a$} if
  for all $\varepsilon > 0$, there exists $\delta > 0$
  such that $\abs{f(x) - f(a)} < \varepsilon$ whenever
  $x \in A$ and $\abs{x-a} < \delta$.

  If $f$ is continuous at all $a \in A$, we say it is continuous.
\end{defn*}

We also take this theorem from MATH 137 without proof.

\begin{theorem}
  A function $f : A \to \R$ is continuous at $a \in A$ if and only if
  for all sequences $(x_n) \subseteq A$ with $x_n \to a$,
  we have $f(x_n) \to a$.
\end{theorem}

\section{Orbits, revisited}

\begin{prop}
  If $f : [a,b] \to [a,b]$ is continuous, then $f(x)$ has a fixed point.
\end{prop}
\begin{prf}
  We know by the domain and codomain that $f(a) \geq a$ and $f(b) \leq b$.
  This means $f(a) - a \geq 0$ and $f(b) - b \leq 0$.
  By the IVT on the continuous function $g(x) = f(x) - x$,
  we know there exists an $x \in [a,b]$ such that $g(x) = f(x) - x = 0 \iff f(x) = x$,
  i.e., $x$ is a fixed point.
\end{prf}

\begin{defn*}[contraction]
  Let $f : A \to \R, A \subseteq \R$.
  We say $f$ is a \term{contraction} if there exists $C \in [0,1)$
  such that for all $x,a \in A$,
  \[ \abs{f(x) - f(y)} \leq C\abs{x-y} \]
\end{defn*}

This is just a Lipschitz function with Lipschitz constant less than 1.

\begin{prop}\label{prop:cont-cts}
  Contractions are continuous.
\end{prop}
\begin{prf}
  Let $\varepsilon > 0$.
  Suppose $f$ is a contraction such that $\abs{f(x) - f(y)} \leq C\abs{x-y}$.

  Consider $y \in A$.
  Let $\delta = \frac{\varepsilon}{C+1}$
  and assume that $x \in A$ and $\abs{x-y} < \delta$.
  But we have:
  \begin{align*}
    \abs{f(x) - f(y)} \leq C\abs{x-y} \leq C\delta < \varepsilon
  \end{align*}
  as desired.
\end{prf}

\begin{defn*}[closure of an interval]
  We say $A \in \R$ is \term[interval!closure]{closed}
  if whenever $(x_n) \subseteq A$ with $x_n \to x$,
  then $x \in A$.
\end{defn*}

\begin{example}
  $[a,b]$ is closed but $(0,1]$ is not because $\frac1n \to 0 \not\in (0,1]$.
\end{example}

\begin{theorem}[Banach contraction mapping theorem]\label{thm:banach}
  Suppose $A \subseteq \R$ is closed and $f : A \to A$ is a contraction.
  Then, there exists a unique fixed point $a \in A$ for $f$.

  Moreover, for all $x \in A$, $f^n(x) \to a$.
\end{theorem}

\begin{example}
  Analyze the orbit of $f : [0,1] \to [0,1]$, $f(x) = \frac{1}{3-x}$.
\end{example}
\begin{sol}
  We can observe that $\frac13 \leq \frac{1}{3-x} \leq \frac12$.

  Also, $f'(x) = \frac{1}{(3-x)^2}$.
  Notice that $\frac19 \leq \abs{f'(x)} \leq \frac14$.
  So by the mean value theorem, for all $x,y \in [0,1]$,
  there exists $c \in (0,1)$ such that:
  \begin{align*}
    f(x) - f(y)       & = f'(c)(x-y)                \\
    \abs{f(x) - f(y)} & = \abs{f'(c)}\cdot\abs{x-y} \\
                      & \leq \frac14\abs{x-y}
  \end{align*}
  Then, identifying $C = \frac14$, $f$ is a contraction. Now,
  \begin{align*}
    \frac{1}{3-x} = x \iff 1 = 3x-x^2 \iff x^2 - 3x + 1 = 0 \iff x = \frac{3\pm \sqrt{9-4}}{2} \iff x = \frac{3-\sqrt{5}}{2}
  \end{align*}
  where we pick the negative root because we need $x \in [0,1]$.

  Therefore, by the \nameref{thm:banach},
  for all $x \in [0,1]$, $f^n(x) \to \frac{3-\sqrt5}{2}$.
\end{sol}

\lecture{Jan 15}
\begin{defn}
  A sequence $(a_n) \subseteq \R$ is \term{strongly-Cauchy} if there exists
  $(\varepsilon_n) \subseteq [0,\infty)$ such that
  $\sum_{n=1}^\infty \varepsilon_n < \infty$
  and for all $n$, $\abs{a_n - a_{n+1}} < \varepsilon_n$.
\end{defn}

Informally, ``far enough along the sequence, the \emph{neighbours}
must get close''.
This is distinct from Cauchy, which is ``far enough along the sequence,
the \emph{terms} must get close''.

\begin{remark}[assignment hint!]
  Let $\sum_{n=1}^\infty a_n = L$.
  This means that $\sum_{k=1}^n a_k \xto{n\to \infty} L$.

  That is, for all $\varepsilon > 0$, there exists $N \in \N$
  such that $n \geq N$ implies $\abs{\sum_{k=1}^n a_k - L} < \varepsilon$.

  But $\abs{\sum_{k=1}^n a_k - L} = \abs{\sum_{k=1}^\infty a_k - \sum_{k=1}^n a_k}
    = \abs{\sum_{k=n+1}^\infty a_k} < \varepsilon$.
\end{remark}

We can now prove the \nameref{thm:banach}.

\begin{prf}
  Let $A \subseteq \R$ be closed and suppose there exists
  $f : A \to A$ and $C \in [0,1)$ such that $\abs{f(x) - f(y)} \leq C\abs{x-y}$
  for all $x$ and $y$ in $A$.

  Fix $x_0 \in A$ and construct the orbit
  $x_1 = f(x_0)$, $x_2 = f(x_1)$, $\dotsc$, $x_n = f(x_{n-1}) = f^n(x_0)$.

  For $n \in \N$, since $f$ is a contraction,
  \begin{align*}
    \abs{x_{n+1} - x_n}
     & = \abs{f(x_n) - f(x_{n-1})}      \\
     & \leq C\abs{x_n - x_{n-1}}        \\
     & = C\abs{f(x_{n-1}) - f(x_{n-2})} \\
     & \leq C^2\abs{x_{n-1} - x_{n-2}}  \\
     & \vdotswithin{=}                  \\
     & \leq C^n\abs{x_1 - x_0}
  \end{align*}
  Since $\sum_{n=1}^\infty C^n\abs{x_1-x_0} = \abs{x_1-x_0}\sum_{n=1}^\infty C^n$
  is a convergent geometric series, we have that the sequence $(x_n)$ is strongly-Cauchy.

  Hence, by Assignment 1, $x_n \to a$ for some limit point $a \in A$ since $A$ is closed.

  Since $f$ is continuous (\cref{prop:cont-cts}), we have that $f(x_n) \to f(a)$.
  By definition, $f(x_n) = x_{n+1}$, so $x_n \to f(a)$.
  But we already know $x_n \to a$, so $a = f(a)$.
  That is, $a$ is a fixed point of $f$.

  It remains to show uniqueness.

  Suppose $a,b \in A$ such that $f(a) = a$ and $f(b) = b$.
  \begin{align*}
    \abs{f(a) - f(b)} & \leq C\abs{a-b} \\
    \abs{a-b}         & \leq C\abs{a-b}
  \end{align*}
  Since $C < 1$, we must have $\abs{a-b} = 0$, that is, $a = b$.
\end{prf}

\chapter{Graphical Analysis}

\section{Cobweb plots}

Recall \cref{ex:graph}.
To visualize the orbit of $a$ under $f$, we can:
\begin{enumerate}[noitemsep]
  \item Superimpose $y=f(x)$ over the line $y=x$.
  \item Connect a vertical line $(a,a) - (a,f(a))$
  \item Connect a horizontal line $(a,f(a)) - (f(a),f(a))$
  \item Connect a vertical line $(f(a),f(a)) - (f(a), f(f(a)))$
  \item Connect a horizontal line $(f(a), f(f(a))) - (f(f(a)), f(f(a)))$

        etc.
\end{enumerate}
This is sometimes called a \term{cobweb plot}.
We will be using \href{https://marksmath.org/visualization/cobwebs/}{https://marksmath.org/visualization/cobwebs/}
to make cobweb plots.

Within these lecture notes, I use a \LaTeX{} macro to draw plots
\href{https://github.com/RetroCraft/problems/blob/master/latex/agony-pmath370.tex}{defined here}.

\begin{example}
  Conduct a complete orbit analysis of $f(x) = x^2 - x + 1$
\end{example}
\begin{sol}
  Playing around, we find that there is one fixed point $x=1$.

  When $x \in [0,1]$, $f^n(x) \to 1$.
  Otherwise, $f^n(x) \to \infty$.
  \begin{center}
    \cobweb[0.5]{\x^2-\x+1}{10}
    \quad
    \cobweb[-0.5][domain=-1:5,ymax=5]{\x^2-\x+1}{7}
  \end{center}
\end{sol}

\textrule{$\downarrow$ Lectures 5 and 6 adapted from \href{https://www.rosiedefazio.ca}{Rosie} $\downarrow$}
\lecture{Jan 17}

\begin{example}
  Conduct a complete orbit analysis of $f(x) = -\frac32 x^2 + \frac52x + 1$.
\end{example}
\begin{sol}
  At $x = 0$, we can see there is a cycle going from $0 \to 1 \to 2 \to 0$:
  \begin{center}
    \cobweb[0][domain=-0.5:2.5]{-1.5*\x^2 + 2.5*\x + 1}{4}
  \end{center}
  At points near 0, like $x=-0.3$ or $x=0.3$, the graph becomes chaotic:
  \begin{center}
    \cobweb[-0.3][domain=-0.5:2.5]{-1.5*\x^2 + 2.5*\x + 1}{500}
    \quad
    \cobweb[0.3][domain=-0.5:2.5]{-1.5*\x^2 + 2.5*\x + 1}{500}
  \end{center}
  It appears that the cobweb densely covers the graph.
\end{sol}

As an aside, note that we cannot actually hit every point in the interval
because the orbit is countable (i.e., has the same size as the naturals)
but the interval is uncountable.
We will later show that the points are dense (as the rationals are).

\chapter{Fixed Points}

\section{Attracting/repelling fixed point theorems}

\begin{remark}
  If $f(x)$ is continuous and $f^n(a) \to L$, then $f^{n+1}(a) \to f(L)$.
  Therefore, $f(L) = L$ is a fixed point.
\end{remark}

\begin{example}
  The function $f(x) = x^3$ has three fixed points: $0, \pm1$.
  For $x \in (-1,1)$, we see that $f^n(x) \to 0$:
  \begin{center}
    \cobweb[0.9][domain=-0.1:1.1,width=.4\textwidth,height=.4\textwidth]{\x^3}{4}
    \quad
    \cobweb[-0.9][domain=-1.1:0.1,width=.4\textwidth,height=.4\textwidth]{\x^3}{4}
  \end{center}
  It looks like point 0 is \term*{attracting} the orbit.
  For $x \in (-\infty,-1)\cup(1,\infty)$, we see $f^n(x) \to \infty$:
  \begin{center}
    \cobweb[1.01][domain=0.9:2,ymax=4,width=.4\textwidth,height=.4\textwidth]{\x^3}{4}
    \quad
    \cobweb[-1.01][domain=-2:-0.9,ymin=-4,width=.4\textwidth,height=.4\textwidth]{\x^3}{4}
  \end{center}
  so the points $\pm1$ are \term*{repelling} the orbit.
\end{example}

\begin{example}
  The function $f(x) = x^3 - 3x$ also has three fixed points: $0, \pm2$.
  To the right (left) of $\pm 2$, orbits go to infinity:
  \begin{center}
    \cobweb[-2.01][domain=-4.1:-1.9,ymin=-5,width=.4\textwidth,height=.4\textwidth]{\x^3 - 3*\x}{3}
    \quad
    \cobweb[2.01][domain=1.9:4.1,ymax=5,width=.4\textwidth,height=.4\textwidth]{\x^3 - 3*\x}{3}
  \end{center}
  The point 0 is repelling (in a different sense) since we get chaos:
  \begin{center}
    \cobweb[0.3][domain=-2:2,width=.4\textwidth,height=.4\textwidth]{\x^3 - 3*\x}{250}
    \quad
    \cobweb[0.3][domain=-2:2,width=.4\textwidth,height=.4\textwidth]{\x^3 - 3*\x}{250}
  \end{center}
  At $x_0 = \pm 1$, the orbit is eventually constant, jumping to the fixed point $\mp 2$:
  \begin{center}
    \cobweb[1][domain=-2:2,width=.4\textwidth,height=.4\textwidth]{\x^3 - 3*\x}{4}
    \quad
    \cobweb[-1][domain=-2:2,width=.4\textwidth,height=.4\textwidth]{\x^3 - 3*\x}{4}
  \end{center}
\end{example}

\begin{defn}
  Let $a$ be a fixed point of $f(x)$.
  \begin{enumerate}[noitemsep]
    \item If $\abs{f'(a)} > 1$, we call $a$ a \term[fixed point!repelling]{repelling} fixed point
    \item If $\abs{f'(a)} < 1$, we call $a$ a \term[fixed point!attracting]{attracting} fixed point
    \item If $\abs{f'(a)} = 1$, we call $a$ a \term[fixed point!neutral]{neutral} fixed point
  \end{enumerate}
  Neutral fixed points can be a lot of different things.
\end{defn}

\begin{theorem}[attracting fixed point theorem]\label{thm:afp}
  Suppose $a$ is an attracting fixed point of $f(x)$.
  Then, there exists an open interval $I$ containing $a$ such that
  \begin{enumerate}[noitemsep]
    \item for all $x \in I$, $n \in \N$, $f^n(x) \in I$
    \item for all $x \in I$, $f^n(x) \to a$
  \end{enumerate}
\end{theorem}

Recall the $\varepsilon$-$\delta$ definition of a limit.

\begin{defn*}[limit of a function at a point]
  Let $f : A \to \R$, $A \subseteq \R$.

  We say a point $a \in A$ is \term{non-isolated} if for each $\varepsilon > 0$
  there exists $b \in A$, $b \neq a$ with $b \in (a-\varepsilon,a+\varepsilon)$.

  Suppose $a$ is non-isolated. We say $\lim_{x\to a}f(x) = L$
  if for all $\varepsilon > 0$, there exists a $\delta > 0$
  such that $\abs{f(x)-L}<\varepsilon$ whenever $a \in A$ and $0 < \abs{x-a} < \delta$.
\end{defn*}

It is important to define non-isolation.
If $a$ is isolated, we can choose a $\delta$ where $\abs{x-a} < \delta$ is false.
Then, every point is vacuously a limit point.

We now give the proof of the \nameref{thm:afp}:
\begin{prf}
  Assume $\abs{f'(a)} < 1$. Then, there exists $c \in \R$ such that $\abs{f'(a)} < c < 1$.
  By definition of the derivative, this means we can write
  \[ \lim_{x\to a}\frac{\abs{f(x)-f(a)}}{x-a} < c \]
  and by the definition of the limit, we know there exists $\delta > 0$ such that
  \[ \frac{\abs{f(x)-f(a)}}{\abs{x-a}} \leq c \qc{\forall x\in (a-\delta,a+\delta)} \]
  Hence, for $x \in I := (a-\delta,a+\delta)$, we have $\abs{f(x)-f(a)} \leq c\abs{x-a}$
  and $f$ is a contraction.

  \lecture{Jan 19}
  In particular, for $x \in I$, we have
  \begin{align*}
    \abs{f(x) - a}
     & = \abs{f(x) - f(a)} \tag{$a$ is a fixed point}     \\
     & \leq c\abs{x-a} \leq \abs{x-a} \tag{$c \in (0,1)$} \\
     & < \delta
  \end{align*}
  That is, $f(x) \in (a-\delta,a+\delta) = I$.
  Continuing for the rest of the orbit, for all $n \in \N$,
  \[ \abs{f^n(x) - a} \leq c^n\abs{x-a} \leq \abs{x-a} < \delta \]
  so we also have $f^n(x) \in I$.

  Finally, notice that $0 \leq \abs{f^n(x) - a} \leq c^n\abs{x-a}$
  and $c^n\abs{x-a} \to 0$ since $c \in (0,1)$.
  By the squeeze theorem, $\abs{f^n(x)-a} \to 0$.
\end{prf}

\begin{theorem}[repelling fixed point theorem]
  Suppose $a$ is a repelling fixed point for $f(x)$.
  Then, there exists an open interval $I$ containing $a$
  such that for all $x \in I$, $x \neq a$, there exists $n \in \N$
  such that $f^n(x) \not\in I$.
\end{theorem}
\begin{prf}
  Say $\abs{f'(a)} > c > 1$. Then, as above, there exists a $\delta$ such that
  \[ \lim_{x\to a}\frac{\abs{f(x)-f(a)}}{x-a} > c \implies \abs{f(x)-f(a)} \geq c\abs{x-a} \]
  for all $x \in I := (a-\delta,a+\delta)$.

  Since $a$ is a fixed point, $\abs{f(x) - f(a)} = \abs{f(x) - a}$.
  Suppose for a contradiction that for all $n$, $f^n(x) \in I$.
  But since $c > 1$, $\abs{f(n)-a} \geq c^n\abs{x-a} \to \infty$.
  That is, $\delta$ must be arbitrarily large, which it is not.
\end{prf}

\section{Neutral fixed points}

Neutral fixed points can exhibit a lot of different behaviours.

\begin{example}
  For $f(x) = -x$, 0 is a fixed point with $\abs{f'(0)} = 1$. The orbit bounces:
  \begin{center}
    \cobweb[1][domain=-1.5:1.5,width=.4\textwidth,height=.4\textwidth]{-\x}{2}
    \quad
    \cobweb[-1][domain=-1.5:1.5,width=.4\textwidth,height=.4\textwidth]{-\x}{2}
  \end{center}
\end{example}

\begin{example}
  For $f(x) = x - x^2$, $\abs{f'(1)} = 1$ is a neutral fixed point.
  It is attracting from the right and repelling from the left:
  \begin{center}
    \cobweb[0.25][domain=-0.1:0.4,width=.4\textwidth,height=.4\textwidth]{\x-\x^2}{10}
    \quad
    \cobweb[-0.1][domain=-0.4:0.1,xmin=-0.4,width=.4\textwidth,height=.4\textwidth]{\x-\x*\x}{9}
  \end{center}
\end{example}

\begin{example}
  For $f(x) = x - x^3$, $\abs{f'(0)} = 1$ is a neutral fixed point.
  It is \term[fixed point!attracting!weakly]{weakly attracting},
  attracting but too slowly.
  \begin{center}
    \cobweb[-0.6][domain=-1:0,width=.4\textwidth,height=.4\textwidth]{\x - \x^3}{10}
    \quad
    \cobweb[0.6][domain=0:1,width=.4\textwidth,height=.4\textwidth]{\x - \x^3}{10}
  \end{center}
\end{example}

\begin{example}
  For $f(x) = x + x^3$, $\abs{f'(0)} = 1$ is a neutral fixed point.
  It is \term[fixed point!repelling!weakly]{weakly repelling},
  repelling but too slowly:
  \begin{center}
    \cobweb[-0.2][domain=-1:0,ymin=-1,width=.4\textwidth,height=.4\textwidth]{\x^3 + \x}{15}
    \quad
    \cobweb[0.2][domain=0:1,ymax=1,width=.4\textwidth,height=.4\textwidth]{\x^3 + \x}{15}
  \end{center}
\end{example}

\begin{example}
  Consider $f(x) = x^2 - 1$.
  The orbit at $a = 0$ is periodic ($0,-1,0,-1,\dots$) with period 2.
  Near 0, the orbit tends to the $(0,-1)$-cycle:
  \begin{center}
    \cobweb[-0.5][domain=-1.1:0.1,width=.4\textwidth,height=.4\textwidth]{\x*\x - 1}{50}
    \quad1
    \cobweb[0.6][domain=-1.1:0.9,width=.4\textwidth,height=.4\textwidth]{\x*\x - 1}{50}
  \end{center}
  We will call 0 an \term*{attracting periodic point}
  because 0 is an attracting point of $f^2(x)$.
\end{example}

\textrule{$\uparrow$ Lectures 5 and 6 adapted from \href{https://www.rosiedefazio.ca}{Rosie} $\uparrow$}

\lecture{Jan 22}

\begin{defn}
  Let $a$ be a periodic point for $f(x)$ with period $n$.

  We say $a$ is an \term[periodic point!attracting]{attracting}/\term[periodic point!repelling]{repelling}/\term[periodic point!neutral]{neutral periodic point}
  if $a$ is an attracting/repelling/neutral fixed point of $f^n$
\end{defn}

Finding a closed form expression for something like $f^{10}(x)$
is a nightmare, so we need a better way.

\begin{prop}
  Let $f(x)$ be a differentiable function.
  Then, $(f^n)'(x) = f'(x)\cdot f'(f(x))\dotsb f'(f^{n-1}(x))$.
\end{prop}
\begin{prf}
  Proceed by induction on $n$.

  If $n=1$, we have $f'(x) = f'(x)$ and we are done.

  Suppose $(f^n)'(x) = \prod_{k=0}^{n-1} f'(f^k(x))$ for some $n \geq 1$.
  Consider $f^{n+1}$:
  \begin{align*}
    \dv{x} f^{n+1}(x) = \dv{x} f(f^n(x)) = f'(f^n(x))\cdot(f^n)'(x)
  \end{align*}
  by the chain rule. Then,
  \begin{align*}
    (f^{n+1})'(x)
     & = f'(f^n(x))\cdot(f^n)'(x)                    \\
     & = f'(f^n(x))\cdot\prod_{k=0}^{n-1} f'(f^k(x)) \\
     & = \prod_{k=0}^{n} f'(f^k(x))
  \end{align*}
  completing the proof.
\end{prf}

\begin{example}
  Analyze the periodic point $f(x) = -\frac32x^2+\frac52x+1$, $a=0$
\end{example}
\begin{sol}
  The orbit is $(0,1,2,0,1,2,\dotsc)$ with period 3.

  We have $f'(x) = -3x + \frac52$.
  Then, $(f^3)'(0) = f'(0)f'(1)f'(2) = (-\frac72)(-\frac12)(\frac52) = \frac{35}{8} > 1$.

  Therefore, the point is repelling.
\end{sol}

\chapter{Bifurcations}

In general, bifurcation theory is the study of how a family of curves
can change when a defining parameter is changed.

\section{Quadratic family}

Consider the \term{quadratic family}:
\[ Q_C(x) = x^2 + C \]
defined by the parameter $C \in \R$.

\begin{problem}
  How does the behaviour (fixed points, orbits, etc.) of $Q_C$ change based on $C$?
\end{problem}

First, we can find the fixed points (if they exist) by solving
\[ Q_C(x) = x \iff x^2 - x + C = 0 \iff x = \frac{1\pm\sqrt{1-4C}}{2} \]
and note that $Q_C(x)$ has 2 fixed points when $C < \frac14$,
1 fixed point when $C = \frac14$, and
no fixed points when $C > \frac14$.

Suppose $C > \frac14$.
Then, we must have $Q_C^n(x) \to \infty$ for all $x$.

Instead, if $C = \frac14$, $Q_C(x)$ has the unique fixed point $p=\frac12$.
Since $Q_C'(x) = 2x$ and $Q_C'(p) = 1$, this is a neutral fixed point.
In fact, it attracts to one side and repels from the other.

Finally, if $C < \frac14$, $Q_C(x)$ has two fixed points
$p_+ = \frac{1+\sqrt{1-4C}}{2}$ and $p_- = \frac{1-\sqrt{1-4C}}{2}$.
Then, $Q_C'(p_+) = 1+\sqrt{1-4C} > 1$ is repelling.
Next,
\begin{align*}
       & -1 < Q_C'(p_-) < 1     \\
  \iff & -1 < 1-\sqrt{1-4C} < 1 \\
  \iff & -2 < -\sqrt{1-4C} < 0  \\
  \iff & 0 < \sqrt{1-4C} < 2    \\
  \iff & -\frac34 < C < \frac14 \\
\end{align*}
and in fact if $C < -\frac34$, $Q'_C(p_-) < -1$
and if $C = -\frac34$, $Q'_C(p_-) = -1$.

\begin{theorem}
  For the family
  \[ Q_C(x) = x^2 + C, \]
  depending on $C$:
  \begin{enumerate}
    \item All orbits tend to $\infty$ if $C > \frac14$.
    \item When $C = \frac14$, $Q_C(x)$ has a unique fixed point $\frac12$ and it is neutral.
    \item If $C < \frac14$, $Q_C(x)$ has two fixed points $p_+$ and $p_-$.
          The point $p_+$ is repelling.
          Moreover,
          \begin{enumerate}[(a),nosep]
            \item if $-\frac34 < C < \frac14$, $p_-$ is attracting;
            \item if $C = -\frac34$, $p_-$ is neutral; and
            \item if $C < -\frac34$, $p_-$ is repelling.
          \end{enumerate}
  \end{enumerate}
\end{theorem}

\pagebreak
\phantomsection\addcontentsline{toc}{chapter}{Back Matter}
\renewcommand{\listtheoremname}{List of Named Results}
\phantomsection\addcontentsline{toc}{section}{\listtheoremname}
\listoftheorems[ignoreall,numwidth=3em,onlynamed={theorem,lemma,corollary,prop}]
\printindex

\end{document}
