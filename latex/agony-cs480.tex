% Pseudocode
\RequirePackage{algorithm,float}
\RequirePackage[noEnd]{algpseudocodex}
\renewcommand{\ipsep}{,}

% Macros
\newcommand{\e}{\vb{e}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\h}{\vb{h}}
\renewcommand{\k}{\vb{k}}
\newcommand{\normal}{\mathcal{N}}
\newcommand{\p}{\vb{p}}
\newcommand{\q}{\vb{q}}
\newcommand{\T}{\vb{T}}
\newcommand{\U}{\vb{U}}
\renewcommand{\v}{\vb{v}}
\newcommand{\w}{\vb{w}}
\newcommand{\W}{\vb{W}}
\newcommand{\x}{\vb{x}}
\newcommand{\X}{\vb{X}}
\newcommand{\y}{\vv{y}}
\newcommand{\Y}{\vv{Y}}
\newcommand{\z}{\vb{z}}
\newcommand{\0}{\vb{0}}
\newcommand{\vth}{\symbf{\theta}}
\newcommand{\vmu}{\symbf{\mu}}
\newcommand{\vphi}{\symbf{\phi}}
\renewcommand{\vec}{\overrightarrow}
\DeclareMathOperator*{\E}{\mathbb{E}}
\DeclareMathOperator{\Loss}{Loss}
\DeclareMathOperator{\hinge}{hinge}
\DeclareMathOperator{\sigmoid}{sigmoid}
\DeclareMathOperator{\softmax}{softmax}
\DeclareMathOperator{\ReLU}{ReLU}
\DeclareMathOperator{\Vector}{Vector}
\DeclareMathOperator{\KL}{KL}
\newcommand{\bit}{\{0,1\}}
\newcommand{\score}{\vv{score}}
\newcommand{\cir}{\vv{circ}}

% Redefine xmat to begin indexing at 0
\DeclareDocumentCommand\Xmatrix{ s m m m }
{
    {
        \newtoks\matrixtoks
        \global\matrixtoks = {}
        \newcount\rowcount
        \newcount\colcount
        \rowcount = -1
        \loop
        \colcount = -1
        \advance \rowcount by 1
        {
            \loop
            \advance \colcount by 1
            \edef\addtoks{\ifnum \colcount = 0 \else & \fi #2 \IfBooleanTF{#1}{_{\ifnum #3 > 0 \the\rowcount \fi \ifnum #4 > 0 \the\colcount \fi}}{}}
            \global\matrixtoks = \expandafter{\the\expandafter\matrixtoks\addtoks}
            \ifnum \colcount < #4
            \repeat
        }
        \ifnum \rowcount < #3
            \global\matrixtoks = \expandafter{\the\matrixtoks \\ }
            \repeat
    }
    \the\matrixtoks
}
\DeclareDocumentCommand\Xmat{}{\Xmatrix}
